<html><head><script type='text/javascript' src='jquery-latest.js'></script><link rel='stylesheet' type='text/css' href='SfApexDoc.css' /> <script>$(document).ready(function() {$('.toggle_container').hide();
$('h2.trigger').click(function() {
$(this).toggleClass('active').next().slideToggle('fast');ToggleBtnLabel(this.firstChild);return false; });});
function gotomenu(url) {document.location.href = url;}
function ToggleBtnLabel(ctrl) {ctrl.value = (ctrl.value=='+' ? '-' : '+');}
function IsExpanded(ctrl) {return (ctrl.value == '-');}
function ToggleAll(e) {var cExpanded = 0;$('h2.trigger', $(e).closest('tr')).each(function() {if (!IsExpanded(this.firstChild)) {$(this).toggleClass('active').next().slideToggle('fast');ToggleBtnLabel(this.firstChild);cExpanded++;}});if (cExpanded == 0) {$('h2.trigger', $(e).closest('tr')).each(function() {$(this).toggleClass('active').next().slideToggle('fast');ToggleBtnLabel(this.firstChild);});}}
</script></head><body><div class='topSection'><table><tr><td><img id='logo' src='logo.png'/></td><td><h2>Project Demo</h2>(specify an -author parameter to override this)<br/><a href='https://gitlab.com/StevenWCox/sfapexdoc/wikis/Home'>(GitLab project)</a><br/></td></tr></table></div><table width='100%'><tr><td class='leftmenus' rowspan='100'><div onclick="gotomenu('index.html');">Home</div><div onclick="gotomenu('csutils.html');">CSUtils</div><div onclick="gotomenu('drivewealth.html');">DriveWealth</div><div onclick="gotomenu('drivewealthapi.html');">DriveWealthAPI</div><div onclick="gotomenu('drivewealthjsonaccount.html');">DriveWealthJsonAccount</div><div onclick="gotomenu('drivewealthjsonaccount_test.html');">DriveWealthJsonAccount_Test</div><div onclick="gotomenu('drivewealthjsoninstrument.html');">DriveWealthJsonInstrument</div><div onclick="gotomenu('drivewealthjsonsession.html');">DriveWealthJsonSession</div><div onclick="gotomenu('httpmockresponse.html');">HTTPMockResponse</div><div onclick="gotomenu('httputilities.html');">HTTPUtilities</div><div onclick="gotomenu('sfdcaccesscontrolexception.html');">SFDCAccessControlException</div><div onclick="gotomenu('sfdcaccesscontroller.html');">SFDCAccessController</div><div onclick="gotomenu('util.html');">Util</div></td><td class='classCell'><h2 class='section-title'>DriveWealth<span><input type='button' value='+/- all' onclick='ToggleAll(this);' /></span></h2><div class='toggle_container_subtitle'>public with sharing class <a href='drivewealth.html'>DriveWealth</a></div><table class='details' rules='all' border='1' cellpadding='6'><tr><th>Description</th><td>DriveWealth class is wrapper fto DriveWealthAPI This class takes care of calling API methods, handling errors, dealing with database (for session) and more</td></tr><tr><th>Author</th><td>Jaswinder Rattanpal <jrattanpal@salesforce.com></td></tr></table><p></p><h2 class='trigger'><input type='button' value='+'/>&nbsp;&nbsp;<a href='#'>Properties</a></h2><div class='toggle_container'><table class='properties' border='1' rules='all' cellpadding='6'><tr><th class='clsPropertyName'>dws</th><td><div class='clsPropertyDeclaration'>public static DW_Session__C dws</div><div class='clsPropertyDescription'>Get DriveWealth session information from DW_Session__c object Name of a record for a session will show as "Account:DW_SESSION_KEY"</div></tr></table></div><h2 class='section-title methods'>Methods</h2><h2 class='trigger'><input type='button' value='+'/>&nbsp;&nbsp;<a href='#'>createPracticeAccount</a></h2><div class='toggle_container'><div class='toggle_container_subtitle'>public static <a href='drivewealthjsonaccount.html'>DriveWealthJsonAccount</a> createPracticeAccount(Map&#60;<a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a></a>, <a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a></a>&#62; data)</div><table class='details' rules='all' border='1' cellpadding='6'><tr><th>Description</th><td>Create a Practice Account Ensure that init() is called before this to make sure there is valid session  <pre>
     //Set this if you need to see debug statements
     //Util.debug = true;
     //If there is no DW User ID" AND/OR "DW Account ID" associate with (standard) Account
     //Then create new Practice account
     //Hint: Use SOQL or initial data load to get this informaiton in, say, Lightning Component
     //Custom setting to get "referralCode" needed to create account
     DriveWealth__c dw = DriveWealth__c.getInstance() ;
      String username = 'sfusername';
      String password = 'sfpassword';
     //Data for Practice Account Creation
     Map<String, String> data = new Map<String, String> ();
     data.put('emailAddress1', 'test@test.com');//Pull from Account
     data.put('firstName', 'FirstName');//Pull from Account
     data.put('lastName', 'LastName');//Pull from Account
     data.put('username', username);
     data.put('password', password);
     data.put('referralCode', dw.Referral_Code__c);
     System.debug(data);
     //There is no setup because we want to use new username info for login
     //Create practice account
     DriveWealthJsonAccount aInfo = DriveWealth.createPracticeAccount(data);
     //userID as returned after creating user
     String DWUserID = aInfo.userID;
     DriveWealthJsonSession sessionInfo = DriveWealth.doSetup('00141000007RP8r', username, password);
     String DWAccountID = sessionInfo.Accounts[0].accountID;
     System.debug(sessionInfo);
     System.debug(DWAccountID);
     //Do DML here to store new username, password, DW User ID and DW Account ID in Account
     Account acc = [select id from account where id='00141000007RP8t'];
     acc.DW_Account_ID__c = DWAccountID;
     acc.DW_User_ID__c = DWUserID;
     acc.DW_Username__c = username;
     acc.DW_Password__c = password;
     update acc;
     //Update new session Info from DriveWealth
     DriveWealth.doCleanup();
 </pre></td></tr><tr><th>Returns</th><td>DriveWealthJsonAccount</td></tr><tr><th colspan='2' class='paramHeader'>Parameters</th></tr><tr><th class='param'>data</th><td>Map of data to be sent to DriveWealth for creating practice account </td></tr></table></div><h2 class='trigger'><input type='button' value='+'/>&nbsp;&nbsp;<a href='#'>doCleanup</a></h2><div class='toggle_container'><div class='toggle_container_subtitle'>public static void doCleanup()</div><table class='details' rules='all' border='1' cellpadding='6'><tr><th>Description</th><td>This is to update session information. But we need to do it AFTER the callouts otherwise we will get following error You have uncommitted work pending. Please commit or rollback before calling out</td></tr></table></div><h2 class='trigger'><input type='button' value='+'/>&nbsp;&nbsp;<a href='#'>doSetup</a></h2><div class='toggle_container'><div class='toggle_container_subtitle'>public static <a href='drivewealthjsonsession.html'>DriveWealthJsonSession</a> doSetup(<a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a> AccountID)</div><table class='details' rules='all' border='1' cellpadding='6'><tr><th>Description</th><td>This is used to prepare information for login. We need Account ID as we need to get DriveWealth username/password and other information This function will take care of preparing all that This method should be used before calling any function in this class. This will ensure that proper session is setup (only once) before proceeding</td></tr><tr><th>Returns</th><td>DriveWealthJsonSession</td></tr><tr><th colspan='2' class='paramHeader'>Parameters</th></tr><tr><th class='param'>AccountID</th><td>ID of Account to retrieve information </td></tr></table></div><h2 class='trigger'><input type='button' value='+'/>&nbsp;&nbsp;<a href='#'>doSetup</a></h2><div class='toggle_container'><div class='toggle_container_subtitle'>public static <a href='drivewealthjsonsession.html'>DriveWealthJsonSession</a> doSetup(<a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a></a></a> AccountID, <a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a></a></a> Username, <a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a></a></a> Password)</div><table class='details' rules='all' border='1' cellpadding='6'><tr><th>Description</th><td>Same as doSetup but this one takes explicit username/password in case we need to supply it directly and not from Account</td></tr><tr><th colspan='2' class='paramHeader'>Parameters</th></tr><tr><th class='param'>AccountID</th><td>ID of Account to retrieve information </td></tr><tr><th class='param'>Username</th><td>DW Username to login </td></tr><tr><th class='param'>Password</th><td>DW Password to login </td></tr></table></div><h2 class='trigger'><input type='button' value='+'/>&nbsp;&nbsp;<a href='#'>login</a></h2><div class='toggle_container'><div class='toggle_container_subtitle'>public static <a href='drivewealthjsonsession.html'>DriveWealthJsonSession</a> login(<a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a></a> username, <a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'><a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a></a> password)</div><table class='details' rules='all' border='1' cellpadding='6'><tr><th>Description</th><td>Wrapper to login to DriveWealth First check if existing session is valid</td></tr><tr><th>Returns</th><td>DriveWealthJsonSession</td></tr><tr><th colspan='2' class='paramHeader'>Parameters</th></tr><tr><th class='param'>username</th><td>DW Username </td></tr><tr><th class='param'>password</th><td>DW Password </td></tr></table></div><h2 class='trigger'><input type='button' value='+'/>&nbsp;&nbsp;<a href='#'>searchInstrument</a></h2><div class='toggle_container'><div class='toggle_container_subtitle'>public static List&#60;<a href='drivewealthjsoninstrument.html'>DriveWealthJsonInstrument</a>&#62; searchInstrument(<a href='http://www.salesforce.com/us/developer/docs/apexcode/Content/langCon_apex_primitives.htm'>String</a> symbol)</div><table class='details' rules='all' border='1' cellpadding='6'><tr><th>Description</th><td>Search instrument, this is to get Stock Symbol information. This will later be used for orders Ensure that init() is called before this to make sure there is valid session  <pre>
     //Need to login to DriveWealth
     DriveWealth.doSetup('00141000007RP8r');
     List<DriveWealthJsonInstrument> inInfo = DriveWealth.searchInstrument('CRM,AAPL');
     //Update new session Info from DriveWealth
     DriveWealth.doCleanup();
 </pre></td></tr><tr><th>Returns</th><td>DriveWealthJsonSession</td></tr><tr><th colspan='2' class='paramHeader'>Parameters</th></tr><tr><th class='param'>symbol</th><td>One or more (comma separated) symbols; CRM OR CRM,AAPL </td></tr></table></div></td></tr></table></div></div></td></tr></table><hr/><center id='footer'><a href='https://gitlab.com/StevenWCox/sfapexdoc/wikis/Home'>Powered By SfApexDoc version 1.2.5</a></center></body></html>